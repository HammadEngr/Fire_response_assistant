version: "3.1"

rules:
  # ===== BASIC =====
  - rule: Greet
    steps:
      - intent: greet
      - action: utter_greet

  - rule: Goodbye
    steps:
      - intent: goodbye
      - action: utter_goodbye

  # ===== ENTRY =====
  - rule: Start fire report
    steps:
      - intent: report_fire
      - action: action_reset_slots
      - action: utter_fire_reported
      - action: site_selection_form
      - active_loop: site_selection_form

  # ===== SITE SELECTION → ROUTE =====
  - rule: Site selection done
    condition:
      - active_loop: site_selection_form
    steps:
      - action: site_selection_form
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: action_route_after_site_selection

  # ===== HOUSE FORM → SUBMIT =====
  - rule: House fire form done
    condition:
      - active_loop: house_fire_form
    steps:
      - action: house_fire_form
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: action_submit_fire_assessment
